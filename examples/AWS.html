<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>AWS SDK for JavaScript - Browser Getting Started Application</title>
    <link rel="stylesheet" href="aws.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  </head>

  <body>
    <body class="body">
    
      <div class="container py5">
  
          <div class="text-center">
              <h2 class="display-7">PRODUCTS</h2>
          </div>
  
          <div class="row">
              <ul id="home_product"></ul>
          </div>
  
      </div>
  
  </body>

    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.410.0.min.js"></script>
    <script type="text/javascript">

        // Initialize the Amazon Cognito credentials provider
        AWS.config.region = 'eu-west-1'; // RÃ©gion
        AWS.config.credentials = new AWS.CognitoIdentityCredentials({
    IdentityPoolId: 'eu-west-1:a40474e9-d90b-494d-836d-7e55d8f9da3b',
});

AWS.config.getCredentials(function(err) {
  if (err) console.log(err.stack);
  
  // credentials not loaded
  else {
    console.log("Access key:", AWS.config.credentials.accessKeyId);
    const itemsAll = scanAll("VideoAWS");
    itemsAll.then(function(value) {
      for(var i =0;i<100000;i++){
        if(value[i]!== undefined){
      console.log(value[i]);
      loadProducts(value[i]);

      var file = "https://"+value[i].srcBucket+".s3."+AWS.config.region+".amazonaws.com/"+value[i].srcVideo;
      console.log(file);

    }
      }
    // expected output: 123
});

  }
});

const documentClient = new AWS.DynamoDB.DocumentClient();

const scanAll = async (tableName) => {
  let lastEvaluatedKey = 'dummy'; // string must not be empty
  const itemsAll = [];
  let table = { TableName: tableName };


  while (lastEvaluatedKey) {
    const data = await documentClient.scan(table).promise();
    itemsAll.push(...data.Items);
    lastEvaluatedKey = data.LastEvaluatedKey;
    if (lastEvaluatedKey) {
      table.ExclusiveStartKey = lastEvaluatedKey;
    }
  }
  return itemsAll;
}


function loadProducts(data){

var li = document.createElement('li');

li.innerHTML = '<div class="card mt-1">'+
'<div class="product-1 align-items-center p-2 text-center"> <img src="'+data.thumbNailsUrls+'" class="rounded" width="150" height="100">'+
    '<h6 class="mt-0 font-weight-bold mb-2 info">'+data.srcVideo+'</h6>'+
    '<div class="mt-3 info"> <span class="text1 d-block">'+ data.srcBucket+' </span> </div>'+
    '<div class=" cost mt-1 text-dark"> <span>$'+data.srcBucket+'</span>'+
    '</div>'+
'</div>'+
'<div class="button-color p-2 text-center text-white"> <span class="text-uppercase ">Add to cart</span> </div>'+
'</div>';
const div = li.firstChild;
li.setAttribute('id', data.guid);


var messageElement = li.querySelector('button-color p-2 text-center text-white');
var file = "https://"+data.srcBucket+".s3."+AWS.config.region+".amazonaws.com/"+data.srcVideo;
console.log(file);

    messageElement.addEventListener('click', false);


document.getElementById("home_product").appendChild(li);
    }

     function myFunc(evt) {
  var test = evt.currentTarget.myParam;
console.log(test);
}
    </script>
  </body>
</html>