<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!--favmicon -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<script src="/js/jquery.min.js"></script>	
<script src="/js/aws-sdk-2.487.0.min.js"></script>
<script src="/js/aws-cognito-sdk.min.js"></script>
<script src="/js/amazon-cognito-identity.min.js"></script>
<script src="https://sdk.amazonaws.com/js/aws-sdk-2.410.0.min.js"></script>
<script src="/js/awsuploadvideotest.js"></script>
<link type="text/css" rel="stylesheet" href="/css/menubar_left.css">
<link rel="apple-touch-icon" sizes="180x180" href="css/favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="css/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="css/favicon/favicon-16x16.png">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">
<link href='https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css' rel='stylesheet'>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css">
<link type="text/css" rel="stylesheet" href="/bootstrap/css/bootstrap.css">
<link type="text/css" rel="stylesheet" href="/css/shop-homepage.css">
<link type="text/css" rel="stylesheet" href="/css/index.css">

<!-- Custom styles for this template -->
<style>
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@200;300;400;500;600;700&display=swap');
*{
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: "Poppins" , sans-serif;
}

.footer-basic {
  padding:40px 0;
  background-color:#ffffff;
  color:#4b4c4d;
}

.footer-basic ul {
  padding:0;
  list-style:none;
  text-align:center;
  font-size:18px;
  line-height:1.6;
  margin-bottom:0;
}

.footer-basic li {
  padding:0 10px;
}

.footer-basic ul a {
  color:inherit;
  text-decoration:none;
  opacity:0.8;
}

.footer-basic ul a:hover {
  opacity:1;
}

.footer-basic .social {
  text-align:center;
  padding-bottom:25px;
}

.footer-basic .social > a {
  font-size:24px;
  width:40px;
  height:40px;
  line-height:40px;
  display:inline-block;
  text-align:center;
  border-radius:50%;
  border:1px solid #ccc;
  margin:0 8px;
  color:inherit;
  opacity:0.75;
}

.footer-basic .social > a:hover {
  opacity:0.9;
}

.footer-basic .copyright {
  margin-top:15px;
  text-align:center;
  font-size:13px;
  color:#aaa;
  margin-bottom:0;
}

.icon-container {
  position: fixed;
  top: 0;
  right: 0;
  margin: 30px;
}

.fa-upload {
  font-size: 24px;
  color: rgb(255, 255, 255);
}
.fa-thumbs-up {
  font-size: 18px;
  color: rgb(255, 255, 255);
}



.fa:hover {
    opacity: 0.7;
}

.outer-circle {
    width: 5rem;
    height: 5rem;
    background-color: #fff;
    margin: auto;
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    border-radius: 50%;
}

.inner-circle {
    border-radius: inherit;
    background-image: conic-gradient(#fff, rgba(179, 203, 187, 0.3), rgb(243, 243, 243));
    position: absolute;
    z-index: -1;
    margin: auto;
    top: -0.8rem;
    bottom: -0.8rem;
    left: -0.8rem;
    right: -0.8rem;
    animation: circle-anim 0.6s linear infinite;
}

</style>
<style>
  form {
  width: 100%;
  margin: 50px auto;
  border: 1px solid rgba(204, 204, 204, 0);
  border-radius: 10px;
  background-color: #f7f7f700;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0);
  font-family: sans-serif;
}

form h2 {
  text-align: center;
  margin: 0;
  padding: 20px;
  color: #333;
  font-size: 24px;
  border-bottom: 1px solid #ccc;
}

form label {
  display: block;
  margin: 20px 20px 10px;
  font-size: 16px;
  color: #333;
}

form input[type="text"]{
  width: calc(100% - 40px);
  padding: 5px 20px;
  margin-bottom: 20px;
  border: 1px solid #ccc;
  border-radius: 5px;
  font-size: 16px;
  transition: 0.2s ease-in-out;
}

form input[type="text"]:focus {
  border: 1px solid #4caf50;
  box-shadow: 0 0 10px rgba(76,175,80,0.5);
}

form button[type="submit"] {
  width: calc(100% - 40px);
  padding: 0px;
  margin-top: 0px;
  border: none;
  border-radius: 5px;
  background-color: #4caf50;
  color: #fff;
  font-size: 16px;
  cursor: pointer;
  transition: 0.2s ease-in-out;
}

form button[type="submit"]:hover {
  background-color: #43a047;
}

.fa {
  padding: 20px;
  font-size: 30px;
  width: 50px;
  text-align: center;
  text-decoration: none;
  margin: 5px 2px;
}

.rows {
    display: inline-block;
    overflow: auto;
    overflow-y: hidden;
    max-width: 100%;
    margin: 0 0 4em;
    white-space: nowrap;
}


.rows li {
    display: inline-block;
    vertical-align: top;
}


a {
color: #f0f0f0;
text-decoration: none;
background-color: transparent;
}
p {
color: #f0f0f0;
}

.fa-twitter {
  background: #55ACEE;
  color: white;
}
.sm_icon{
 
  width: 50px;
  /* the heigt is adjusted automatically*/
}

ul li{
  padding-left: 0;
  margin: 0;
  list-style-position: inside;
  list-style-type: none;
}
.entete {

letter-spacing: 4px;
margin-top: 0;
margin-bottom: 1rem;
color: rgb(255, 255, 255);
}
ul {
  padding-right: 0%;
  margin: 0;
  list-style-position: inside;
  list-style-type: none;
}

.containerrow {
  background-color:#2e427200;
  display:flex;
  position: fixed;
  bottom: -5%;
  width: 90%;
  z-index: 9;
}


@keyframes circle-anim {
    0% {
        transform: rotate(0deg);
    }
    100% {
        transform: rotate(360deg);
    }
}

.buttonload {
    background-color: white;
    color: black;
    border-radius: 10px;
    padding: 10px 20px;
    font-size: 16px;
    border: none;
    transition: 0.3s;
    
}

</style>

  <link rel="manifest" href="css/favicon/site.webmanifest">
  <link rel="mask-icon" href="css/favicon/safari-pinned-tab.svg" color="#5bbad5">
  
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">

  <title>Virtual Film Fstival</title>

  <!-- Boottrap core CSS -->
 

</head>

<body>
    <script src="/js/fas.js"></script>
        <script src="utils.js"></script>
        <video id="video" loop crossOrigin="anonymous" webkit-playsinline style="display:none">
          <source  id="source" src="video.mp4" type="video/mp4">   
          </video>
      <script id="vertexShader" type="glsl">

    varying vec2 vUv;
    void main( void ) {
      vUv = uv;
      gl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.0);
    }

    </script>


    <script id="fragmentShader" type="glsl">

    uniform vec3 keyColor;
    uniform float similarity;
    uniform float smoothness;
    varying vec2 vUv;
    uniform sampler2D map;
    void main() {

      vec4 videoColor = texture2D(map, vUv);

      float Y1 = 0.299 * keyColor.r + 0.587 * keyColor.g + 0.114 * keyColor.b;
      float Cr1 = keyColor.r - Y1;
      float Cb1 = keyColor.b - Y1;

      float Y2 = 0.299 * videoColor.r + 0.587 * videoColor.g + 0.114 * videoColor.b;
      float Cr2 = videoColor.r - Y2;
      float Cb2 = videoColor.b - Y2;

      float blend = smoothstep(similarity, similarity + smoothness, distance(vec2(Cr2, Cb2), vec2(Cr1, Cb1)));
      gl_FragColor = vec4(videoColor.rgb, videoColor.a * blend);
    }

    </script>
      <script src="https://cdn.jsdelivr.net/npm/hls.js@1"></script>
    
      <div class="sidebar">
        <div class="logo-details">
          <i class='bx bxl-c-plus-plus icon'></i>
            <div class="logo_name">Hub</div>
            <i class='bx bx-menu' id="btn" ></i>
        </div>
        <ul id="navbutton" class="nav-list">
          <li>
              <i class='bx bx-search' ></i>
             <input id="myInput" type="text" placeholder="Search...">
             <span class="tooltip">Search</span>
             <button  id="btnvideos" onclick="window.app.showRowVideos()"><i class="fas fa-arrow-circle-down"></i></button>

          </li>

          <li id="profile">
            <a id="profilhref" href="https://livear.herokuapp.com/profile">
              <i class='bx bx-cart-alt' ></i>
              <span class="links_name">Profil</span>
            </a>
            <span class="tooltip">Profil</span>
          </li>
          <li>
            <a href="https://livear.herokuapp.com/home">
              <i class='bx bx-grid-alt'></i>
              <span class="links_name">AR</span>
            </a>
             <span class="tooltip">AR</span>
          </li>
          <li>
            <a href="https://livear.herokuapp.com/exp">
               <i class='bx bx-user' ></i>
               <span class="links_name">3D Video</span>
             </a>
             <span class="tooltip">3D Video</span>
           </li>
           <li >
            <a href="https://livear.herokuapp.com/preview">
               <i class='bx bx-user' ></i>
               <span class="links_name">Preview 3D</span>
             </a>
             <span class="tooltip">Preview 3D</span>
           </li>
         <li class="hide" id="login">
           <a  href="https://livear.herokuapp.com/login">
             <i class='bx bx-chat' ></i>
             <span class="links_name">Login</span>
           </a>
           <span class="tooltip">Login</span>
         </li>
        
         <li class="hide" id="upload">
           <a  href="upload.html">
             <i class='bx bx-folder' ></i>
             <span class="links_name">Upload</span>
           </a>
           <span class="tooltip">Upload</span>
         </li>
         <li  id="ads">
          <a  href="https://livear.herokuapp.com/broadcaster">
            <i class='bx bx-folder' ></i>
            <span class="links_name">Ads Business</span>
          </a>
          <span class="tooltip">Ads Business</span>
        </li>
         <li id="logout">
          <a id="logouthref" href="">
            <i class='bx bx-pie-chart-alt-2' ></i>
            <span id="logouttext" class="links_name">Logout</span>
          </a>
          <span  class="tooltip">Logout</span>
        </li>
         <!-- <li>
           <a href="ChatGPT.html">
             <i class='bx bx-heart' ></i>
             <span class="links_name">ChatGPT</span>
           </a>
           <span class="tooltip">ChatGPT</span>
         </li>
         <li>
           <a href="#">
             <i class='bx bx-cog' ></i>
             <span class="links_name">Setting</span>
           </a>
           <span class="tooltip">Setting</span>
         </li>
         <li class="profile">
             <div class="profile-details">
               <img src="profile.jpg" alt="profileImg">
               <div class="name_job">
                 <div class="name">Prem Shahi</div>
                 <div class="job">Web designer</div>
               </div>
             </div>
         </li>-->
        </ul>
      </div>

     

  <!-- Navigation 
  <nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top">
    <div class="container">
      <a class="navbar-brand" href="#"><img src="assets/ar-shop/logo-nav.jpg"/>Hub</a>
      <button  id="btnvideos" onclick="window.app.showRowVideos()"><i class="fas fa-arrow-circle-down"></i></button>

      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item active">
            <a class="nav-link" href="index3.html">Home
              <span class="sr-only">(current)</span>
            </a>
            <a class="nav-link" href="experience.html">Desktop
            </a>
            <a id="login" class="nav-link" href="loginAWS.html">Login
            </a>
            <a id="logout" class="nav-link" href="">Log Out
            </a>
            <a id="upload" class="nav-link" href="upload.html">Upload video
            </a>
            <a id="upload" class="nav-link" href="profile.html">Profile
            </a>
            <a id="upload" class="nav-link" href="ChatGPT.html">ChatGPT
            </a>
          </li>
        
        </ul>
      </div>
    </div>
  </nav>-->

  <video id="video" loop crossOrigin="anonymous" webkit-playsinline style="display:none">
    <source  id="source" src="video.mp4" type="video/mp4">   
    </video>
    <div id="circleprogress" class="outer-circle">
      <div class="inner-circle">
          
      </div>
  </div>
  
  <!-- Page Content -->
  <div  class="container">
   

    <i class='bx bx-log-out' id="log_out" ></i>
    <div id="uploadtop" class="icon-container">
      <i class="fa fa-upload"></i>
    </div>
    <div  id="movielist" class="containerrow py5">
  
      <div class="rows">
        <ul id="ar_product"></ul>
      </div>
    
    </div>



    <div class="row">

    
      <!-- /.col-lg-3 -->

      <div class="col-lg-9">

        <div class="w3-container w3-content w3-center w3-padding-64" style="max-width:800px" id="band">
          <h2 class="entete">HubAR</h2>
          <p class="entete">An Augmented Reality experiences.</p>
        </div>

        <div id="carouselExampleIndicators" class="carousel slide my-4" data-ride="carousel">
          <ol class="carousel-indicators">
            <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
            <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
            <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
          </ol>
          <div class="carousel-inner" role="listbox">
            <div class="carousel-item active">
              <img class="d-block img-fluid" src="assets/ar-shop/pink.jpg" alt="First slide">
            </div>
            <div class="carousel-item">
              <img class="d-block img-fluid" src="assets/ar-shop/pink.jpg" alt="Second slide">
            </div>
            <div class="carousel-item">
              <img class="d-block img-fluid" src="assets/ar-shop/pink.jpg" alt="Third slide">
            </div>
          </div>
          <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
          </a>
          <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
          </a>
                  <div class="w3-container w3-content w3-center w3-padding-22" style="max-width:800px" id="band">
    <h2 class="w3-wide"></h2>
  </div>
        </div>

        <section class="cta section text-light">
  <div class="container-sm">
    <div class="cta-inner section-inner">
      <div class="cta-header text-center">
        <p class="section-paragraph"></p>
        <div class="cta-cta">
          <a class="button button-primary button-wide-mobile" href="#"></a>
        </div>
        <h2 class="section-title mt-0">Live</h2>
       
      </div>
    </div>
  </div>
</section>

        <section class="cta section text-light">
          <div class="container-sm">
            <div class="cta-inner section-inner">
              <div class="cta-header text-center">
              <!--   <h2 class="section-title mt-0">AR</h2>-->
                <p class="section-paragraph"></p>
                <div class="cta-cta">
                  <a class="button button-primary button-wide-mobile" href="#"></a>
                </div>
              </div>
            </div>
          </div>
        </section>

        <div class="row">

          <section class="cta section text-light">
            <div class="container-sm">
              <div class="cta-inner section-inner">
                <div class="cta-header text-center">
                  <p class="section-paragraph"></p>
                  <div class="cta-cta">
                    <a class="button button-primary button-wide-mobile" href="#"></a>
                  </div>
                   

                   <!--  <form>
                      <input placeholder="Search video" id="myInput" type="text" >
                      <button id="searchbutton" type="submit">Search</button>
                    </form>-->


         <div class="col-lg-4 col-md-6 mb-4">
            <div class="card h-100">
              <a href="experience3DVideo.html"><img class="card-img-top" src="https://d37dhr5745n0y2.cloudfront.net/f/03/90/f0390830c8e24c34784d11af6f8b06567aa94eff.jpg" alt=""></a>
              <div class="card-body">
                <h4 class="card-title">
                  <a href="experience3DVideo.html">Live Montreux Comedy</a>
                </h4>
                <h5></h5>
                <p class="card-text">a immersive 3D comedy experience </p>
                <p class="card-text">start in 4H:40 min</p>
              </div>
              <div class="card-footer">
                <small class="text-muted">&#9733; &#9733; &#9733; &#9733; &#9734;</small>
                <button class="ar-button" onclick="window.open('experience.html',_blank)"><i class="fas fa-camera"></i></button>
              </div>
            </div>
          </div> 
                    
<br>
          <section class="cta section text-light">
            <div class="container-sm">
              <div class="cta-inner section-inner">
                <div class="cta-header text-center">
                  <p class="section-paragraph"></p>
                  <div class="cta-cta">
                    <a class="button button-primary button-wide-mobile" href="#"></a>
                  </div>
                  <h2 class="section-title mt-0">AR</h2>
                 
                </div>
              </div>
            </div>
          </section>
                </div>
              </div>
            </div>
          </section>
      
         
     
      <ul id="home_product"></ul>
      <div style="width: 300px; height: 70px; margin: 0 auto;">
              <!--     <button class="buttonload" id="prev-button">Load More Videos</button> -->
        <button class="buttonload" id="next-button">Load More Videos</button>
    </div>
      <div id="data-container"></div>
      <br>
      <br>
        </div>
        <!-- /.row -->


        <section class="cta section text-light">
          <div class="container-sm">
            <div class="cta-inner section-inner">
              <div class="cta-header text-center">
                <p class="section-paragraph"></p>
                <div class="cta-cta">
                  <a class="button button-primary button-wide-mobile" href="#"></a>
                </div>
                <h2 class="section-title mt-0">Music</h2>
               
              </div>
            </div>
          </div>
        </section>


        <div class="rows">
          <ul id="music_product"></ul>
        </div>
        
        <div class="row">

      <!--    <div class="col-lg-4 col-md-6 mb-4">
            <div class="card h-100">
              <a href="#"><img class="card-img-top" src="assets/ar-shop/template.png" alt=""></a>
              <div class="card-body">
                <h4 class="card-title">
                  <a href="#">New Film</a>
                </h4>
                <h5></h5>
                <p class="card-text">Ready for a new AR experience?</p>
              </div>
              <div class="card-footer">
                <small class="text-muted">&#9733; &#9733; &#9733; &#9733; &#9734;</small>
                <button class="ar-button" onclick="window.app.showChair(3);"><i class="fas fa-camera"></i></button>
              </div>
            </div>
          </div> --> 
</div>


 <!--<section class="cta section text-light">
  <div class="container-sm">
    <div class="cta-inner section-inner">
      <div class="cta-header text-center">
        <p class="section-paragraph"></p>
        <div class="cta-cta">
          <a class="button button-primary button-wide-mobile" href="#"></a>
        </div>
        <h2 class="section-title mt-0">Duo</h2>
       
      </div>
    </div>
  </div>
</section>--> 

<div class="row">

   <!-- <div class="col-lg-4 col-md-6 mb-4">
    <div class="card h-100">
      <a href="#"><img class="card-img-top" src="assets/ar-shop/template.png" alt=""></a>
      <div class="card-body">
        <h4 class="card-title">
          <a href="#">New Film</a>
        </h4>
        <h5></h5>
        <p class="card-text">Ready for a new AR experience?</p>
      </div>
      <div class="card-footer">
        <small class="text-muted">&#9733; &#9733; &#9733; &#9733; &#9734;</small>
        <button class="ar-button" onclick="window.app.showChair(3);"><i class="fas fa-camera"></i></button>
      </div>
    </div>
  </div>
</div>-->
      </div>
      <!-- /.col-lg-9 -->

    </div>
    <!-- /.ro -->

  </div>
  <!-- /.contaier -->
 <button id="btn"  hidden="hidden" class="btn"><i class="fa fa-home"></i></button>

     <input type="range" min="1" max="100" value="50" class="slider" id="myRange"  hidden="hidden">
  <!-- Footer 
  <footer class="py-5 bg-dark">
    <div class="container">
      <p class="m-0 text-center text-white">Copyright &copy; FeelHub AR 2021</p>
    </div>
-->

<!-- 
<footer class="w3-container w3-padding-64 w3-center w3-opacity w3-light-grey w3-xlarge">
<a target="_blank" href="">

</a>


</footer>
  -->

  
  <!-- Bootstrap core JavaScript -->
  <div class="footer-basic">
    <footer>
        <div class="social"><a href="#"><i class="icon ion-social-instagram"></i></a><a href="#"><i class="icon ion-social-snapchat"></i></a><a href="#"><i class="icon ion-social-twitter"></i></a><a href="#"><i class="icon ion-social-facebook"></i></a></div>
        <ul class="list-inline">
            <li class="list-inline-item"><a href="https://www.google.com/">Home</a></li>
            <li class="list-inline-item"><a href="#">Services</a></li>
            <li class="list-inline-item"><a href="#">About</a></li>
            <li class="list-inline-item"><a href="#">Terms</a></li>
            <li class="list-inline-item"><a href="#">Privacy Policy</a></li>
        </ul>
        <p class="copyright">Company Name © 2021</p>
    </footer>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.bundle.min.js"></script>

     


      <script type="module">
        import { App } from './jsm/app.js';

        document.addEventListener("DOMContentLoaded", function(){
            const app = new App();
            window.app = app;
        });
    </script>

<script src="/js/loginAWS.js"></script>


      <script type="module">
        var typerequest=null;
        let exclusiveStartKey = null;
let prevExclusiveStartKey = null;
var nextSearch = {};
var nextParams = {};
  var params=null;
 
        initAWS("")
// Set the table name and key attribute names

const requestVideo = async () => {
  const documentClient = new AWS.DynamoDB.DocumentClient();
  document.getElementById("circleprogress").style.display = "block";
  
  const tableName = 'VideoAWS';
let lastEvaluatedKey = null;
let done = false;


while (!done) {
  var params=null;
  if (document.getElementById("myInput").value.length>0){
   params = {
    TableName: tableName,
    IndexName: 'videotitlesearch-index',
    KeyConditionExpression: 'videotitlesearch = :indexKeyValue',
  ExpressionAttributeValues: {
    ':indexKeyValue': document.getElementById("myInput").value
  }
  };
  }else{
     params = {
    TableName: tableName,
    IndexName: 'workflowStatus-index',
    KeyConditionExpression: 'workflowStatus = :indexKeyValue',
  ExpressionAttributeValues: {
    ':indexKeyValue': 'Complete'
  }
  };
  }
  // If this is not the first page, add the LastEvaluatedKey value to the query arguments
  if (lastEvaluatedKey) {
    params.ExclusiveStartKey = lastEvaluatedKey;
  }

  // Make the query
  
  const response = await documentClient.query(params).promise();

  // Get the items from the response
  const items = response.Items;
  document.getElementById("home_product").innerHTML = "";

  // Process the items
  for (const item of items) {
    // Do something with the item
    loadProducts(item);   
    loadProductsRow(item);
    console.log(item);
  }
  document.getElementById("circleprogress").style.display = "none";

  window.app.checkXR();

  // Update the pagination variables
  lastEvaluatedKey = response.LastEvaluatedKey;
  done = lastEvaluatedKey === undefined;
}








}

function fetchdata(url,typerequest, search){
  fetch(url, {
          method: 'POST',
          body: JSON.stringify({
           typerequest:typerequest,
           search:search
          })
      })
      .then(response => response.json())
      .then(data => {
        console.log(data);
            displayData(data.Items);
            
            nextParams = {
  Limit: 5,
  ExclusiveStartKey: data.LastEvaluatedKey
};

           
            if (!nextParams.ExclusiveStartKey) {
                document.getElementById("next-button").style.display = "none";
            }
        
      })
      .catch(error => {
          console.error(error);
      });


}
function queryDynamoDB(limit,type, search) {
  nextSearch={};
  nextParams={};
  document.getElementById("home_product").innerHTML = "";
  document.getElementById("next-button").style.display = "block";

  const documentClient = new AWS.DynamoDB.DocumentClient();
  document.getElementById("circleprogress").style.display = "block";

  const tableName = 'VideoAWS';
   typerequest=type;

  if(type=="video" || type=="search" && search.length<=0){
    typerequest="video";
    fetchdata('https://8gb9jnvhx7.execute-api.eu-west-1.amazonaws.com/stage1/GetData_Video',typerequest,null);
   
  }else if(typerequest=="search"){
    typerequest="search";
    fetchdata('https://8gb9jnvhx7.execute-api.eu-west-1.amazonaws.com/stage1/Get_VideoSearchName',typerequest,search);
  }
  console.log(typerequest);
}

function retrieveData(isPrev) {
  var params=null;
  if (document.getElementById("myInput").value.length>0){
   params = {
    TableName: tableName,
    IndexName: 'videotitlesearch-index',
    KeyConditionExpression: 'videotitlesearch = :indexKeyValue',
  ExpressionAttributeValues: {
    ':indexKeyValue': document.getElementById("myInput").value
  },
  Limit: 5,
  ExclusiveStartKey: exclusiveStartKey
  };
  }else{
     params = {
    TableName: tableName,
    IndexName: 'workflowStatus-index',
    KeyConditionExpression: 'workflowStatus = :indexKeyValue',
  ExpressionAttributeValues: {
    ':indexKeyValue': 'Complete'
  },

  Limit: 5,
  ExclusiveStartKey: (isPrev) ? prevExclusiveStartKey : exclusiveStartKey
};
  
  }

  documentClient.query(params, function(err, data) {
    if (isPrev) {
                    prevExclusiveStartKey = exclusiveStartKey;
                    exclusiveStartKey = data.LastEvaluatedKey;
                } else {
                    prevExclusiveStartKey = data.LastEvaluatedKey;
                    exclusiveStartKey = null;
                }
                displayData(data);
                toggleButtons();
    });
}

function toggleButtons() {
        var prevButton = document.getElementById("prev-button");
        var nextButton = document.getElementById("next-button");
        prevButton.disabled = (prevExclusiveStartKey === null);
      //  nextButton.disabled = (exclusiveStartKey === null);
    }

    function displayData(data) {
        var html = "";

        
        for (var i = 0; i < data.length; i++) {
        //    html += "<p>" + JSON.stringify(items[i]) + "</p>";
        loadProducts(data[i]);
        loadProductsRow(data[i]);
        }
        document.getElementById("circleprogress").style.display = "none";

        window.app.checkXR();
      //  document.getElementById("data-container").innerHTML = html;
    }

  /*  document.getElementById("prev-button").addEventListener("click", function(){
        retrieveData(true);
    });
    document.getElementById("next-button").addEventListener("click", function(){
        retrieveData(false);
    });*/

    document.getElementById("uploadtop").addEventListener("click", function(){
     if(document.getElementById("ar_product").style.display == "block"){
      document.getElementById("ar_product").style.display = "none";
     }else{
      document.getElementById("ar_product").style.display = "block";
     }
  
    });
function initAWS(channelName){
     
     var userPoolId = 'eu-west-1_3x9L2hsjh';
     var region = 'eu-west-1';
     var identityPoolId = 'eu-west-1:a40474e9-d90b-494d-836d-7e55d8f9da3b';
     //=============== AWS IDs ===============
       var idToken;
     
  
  AWS.config.region = region;

  
  if(isUserLoggedIn()){
    // const itemsAll = scanAll("VideoAWS");
    // itemsAll.then(function(value) {
      document.getElementById("home_product").innerHTML = "";
      document.getElementById("uploadtop").style.display = "none";
      console.log("Login");

    //  requestVideo();
  //  retrieveData(false);

  
  }else{
    console.log("Login not loggedIn");
  }
  queryDynamoDB(5,"video","");

  

  /*   getCognitoIdCredentials().get(function(err) {
   if (err) console.log(err.stack);
   
   // credentials not loaded
   else {
     console.log("Access key:", AWS.config.credentials.accessKeyId);
    // const itemsAll = scanAll("VideoAWS");
    // itemsAll.then(function(value) {
      document.getElementById("home_product").innerHTML = "";
      document.getElementById("uploadtop").style.display = "none";
    queryDynamoDB(5);

    //  requestVideo();
  //  retrieveData(false);
for(var i =0;i<100000;i++){
  if(value[i]!== undefined){

 if(channelName.length>0){
   if(value[i].counterview.toLowerCase().includes(channelName.toLowerCase())){
     loadProducts(value[i]);   
       loadProductsRow(value[i]);

     
   }
   var file = "https://"+value[i].srcBucket+".s3."+AWS.config.region+".amazonaws.com/"+value[i].srcVideo;
 }else{
  loadProducts(value[i]);   
       loadProductsRow(value[i]);


 }

}
}
//window.app.checkXR();
     // expected output: 123
 // });
  
   }
  });*/
  


 /* const documentClient = new AWS.DynamoDB.DocumentClient();
  
  const scanAll = async (tableName) => {
   let lastEvaluatedKey = 'dummy'; // string must not be empty
   const itemsAll = [];
   let table = { TableName: tableName };
  
  
   while (lastEvaluatedKey) {
     const data = await documentClient.scan(table).promise();
     itemsAll.push(...data.Items);
     lastEvaluatedKey = data.LastEvaluatedKey;
     if (lastEvaluatedKey) {
     table.ExclusiveStartKey = lastEvaluatedKey;
     console.log(table.ExclusiveStartKey);
     }
   }
   return itemsAll;
  }*/
function fetchSecondBatch(url,typerequest,search){
  fetch(url, {
          method: 'POST',
          body: JSON.stringify({
            typerequest:typerequest,
            search:search,
            ExclusiveStartKey:nextParams.ExclusiveStartKey
	
          })
      })
      .then(response => response.json())
      .then(data => {

        console.log(data);
            displayData(data.Items);

            nextParams.ExclusiveStartKey = data.LastEvaluatedKey;
            if (!nextParams.ExclusiveStartKey) {
                document.getElementById("next-button").style.display = "none";
            }
      })
      .catch(error => {
          console.error(error);
      });

}

  document.getElementById("next-button").addEventListener("click", () => {
  if(typerequest=="video"){
    fetchSecondBatch('https://8gb9jnvhx7.execute-api.eu-west-1.amazonaws.com/stage1/GetData_Video',typerequest,null);
   

  }else if(typerequest=="search"){
    fetchSecondBatch('https://8gb9jnvhx7.execute-api.eu-west-1.amazonaws.com/stage1/GetData_Video',typerequest,search);
  }
 

});

  let searchBtn = document.querySelector(".bx-search");
  searchBtn.addEventListener("click", ()=>{ // Sidebar open when you click on the search iocn
    // sidebar.classList.toggle("open");
  //   menuBtnChange(); //calling the function(optional)
  var values = document.getElementById("myInput").value;
  queryDynamoDB(5,"search",values);
   });


   function fetchCount(url,guid, count){
    console.log(count);           

  fetch(url, {
          method: 'POST',
          body: JSON.stringify({
           id:guid,
           count:count
          })
      })
      .then(response => response.json())
      .then(data => {
        console.log("success");           
      })
      .catch(error => {
          console.error(error);
      });


}

  const updateName = async (data) => {
    var count =  (+data[2]) + (+1);
    fetchCount("https://8gb9jnvhx7.execute-api.eu-west-1.amazonaws.com/stage1/Get_VideoLIkesCount",data[1],count);
        /*  const documentClient = new AWS.DynamoDB.DocumentClient();
        
          console.log("likescounterlink "+newName);

          const params = {
            TableName: 'VideoAWS',
            Key: {
              guid: data[1],
            },
            UpdateExpression: 'set likescount = :r',
            ExpressionAttributeValues: {
              ':r': newName,
            },
          };
        
          await documentClient.update(params).promise();*/
        }

  document.addEventListener("buttonclick", function (e) {

// alert(e.detail);
var data = e.detail;
if (data != null) {
  localStorage.setItem('testObject', data );
  window.location = "https://admirable-concha-277e68.netlify.app/profile_details.html";

  //console.log(data);
//  var file = "https://"+data.srcBucket+".s3."+AWS.config.region+".amazonaws.com/"+data.srcVideo;



}


});


document.addEventListener("buttonlikes", function (e) {

// alert(e.detail);
var data = e.detail;
if (data != null) {
  var link=data.split('~');
  console.log("likescounterlink "+link);

  updateName(link);
  //console.log(data);
//  var file = "https://"+data.srcBucket+".s3."+AWS.config.region+".amazonaws.com/"+data.srcVideo;

}


});
  
     }




//updateName();
      </script>

<script src="/js/template_listdatavideoindex.js"></script>	
<script src="/js/menubar_left.js"></script>	

</body>

</html>
